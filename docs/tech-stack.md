# 技術スタック

## 1. コア技術

### 1.1 ゲームエンジン

**Phaser3**

- **バージョン**: ^3.80.1
- **用途**: ゲームエンジン、レンダリング、ゲームループ管理
- **公式ドキュメント**: https://photonstorm.github.io/phaser3-docs/
- **公式例**: https://phaser.io/examples

### 1.2 物理エンジン

**Phaser Arcade Physics**

- **用途**: 2D 物理演算、衝突判定、重力処理
- **設定**:
  - 重力: Y 軸方向 600px/s²
  - デバッグモード: 開発時のみ有効

### 1.3 フロントエンドフレームワーク

**Next.js**

- **バージョン**: 16.1.1
- **用途**: React ベースの Web アプリケーションフレームワーク
- **機能**: サーバーサイドレンダリング、ルーティング、ビルドシステム

**React**

- **バージョン**: 19.2.3
- **用途**: UI コンポーネントライブラリ
- **使用機能**: `useEffect`, `useRef` フック

**React DOM**

- **バージョン**: 19.2.3
- **用途**: React の DOM レンダリング

### 1.4 開発言語

**TypeScript**

- **バージョン**: ^5
- **用途**: 型安全な JavaScript の開発
- **設定**: `tsconfig.json` で ES2017 ターゲット、strict モード有効

---

## 2. レンダリング技術

### 2.1 Canvas API

- **用途**: Phaser3 が内部で使用する HTML5 Canvas API
- **機能**: 2D グラフィックスの描画

### 2.2 ピクセルアートレンダリング

- **設定**: `pixelArt: true`
- **用途**: ピクセルアートのクリーンな表示
- **効果**: 画像のスムージングを無効化し、ピクセルパーフェクトな表示

### 2.3 スプライトシート

- **形式**: PNG 画像
- **用途**: キャラクターアニメーション、タイルマップ
- **フレームサイズ**: 48px × 48px（プレイヤーキャラクター）

### 2.4 アニメーションシステム

- **フレームアニメーション**: Phaser3 の `anims.create()` を使用
- **アニメーションタイプ**:
  - 待機アニメーション（静止）
  - 歩行アニメーション（ループ）
  - ジャンプアニメーション（静止）

---

## 3. ゲームシステム技術

### 3.1 シーン管理

- **システム**: Phaser3 Scene API
- **シーン一覧**:
  - `TitleScene` - タイトル画面
  - `MainScene` - メインゲーム画面
  - `DevScene` - 開発・デバッグ画面
  - `ClearScene` - クリア画面

### 3.2 カメラシステム

- **追従カメラ**: プレイヤーを自動追従
- **スクロール範囲**: ワールドサイズに応じて設定
- **オフセット**: プレイヤーが画面中央よりやや左側に配置

### 3.3 スケーリングシステム

- **モード**: `Phaser.Scale.FIT`
- **配置**: `Phaser.Scale.CENTER_BOTH`
- **画面サイズ**: 375px × 333px
- **用途**: 様々なデバイスサイズに対応

### 3.4 入力システム

- **キーボード入力**: Phaser3 CursorKeys API
- **タッチ入力**: バーチャルコントローラー（将来実装予定）
- **対応操作**: 左右移動、ジャンプ

---

## 4. スタイリング

### 4.1 CSS フレームワーク

**Tailwind CSS**

- **バージョン**: ^4
- **用途**: ユーティリティファーストの CSS フレームワーク
- **設定**: PostCSS 経由で統合

**PostCSS**

- **プラグイン**: `@tailwindcss/postcss` ^4
- **用途**: Tailwind CSS の処理

---

## 5. 開発ツール

### 5.1 リンター・フォーマッター

**Biome**

- **バージョン**: ^2.2.0
- **用途**: コードのリンターとフォーマッター
- **コマンド**:
  - `npm run lint` - リンターチェック
  - `npm run format` - コードフォーマット

### 5.2 型定義

- **@types/node**: ^20 - Node.js の型定義
- **@types/react**: ^19 - React の型定義
- **@types/react-dom**: ^19 - React DOM の型定義

---

## 6. 実行環境

### 6.1 ブラウザ

- **プラットフォーム**: Web ブラウザ（Chrome, Firefox, Safari, Edge など）
- **Canvas サポート**: 必須
- **JavaScript エンジン**: モダンブラウザの ES2017+ 対応

### 6.2 Node.js

- **バージョン**: ^20（推奨）
- **用途**: 開発環境、ビルドプロセス

---

## 7. ビルド・実行

### 7.1 開発サーバー

```bash
npm run dev
```

- **フレームワーク**: Next.js 開発サーバー
- **ホットリロード**: 有効
- **ポート**: 3000（デフォルト）

### 7.2 ビルド

```bash
npm run build
```

- **フレームワーク**: Next.js ビルドシステム
- **出力**: 最適化されたプロダクションビルド

### 7.3 プロダクション実行

```bash
npm start
```

- **フレームワーク**: Next.js プロダクションサーバー

---

## 8. パフォーマンス

### 8.1 目標 FPS

- **60FPS**: スムーズなゲームプレイを実現

### 8.2 最適化技術（将来実装予定）

- **オブジェクトプーリング**: メモリ効率の向上
- **画面外オブジェクトの非表示**: レンダリング負荷の軽減
- **動的インポート**: Phaser3 の遅延読み込み

---

## 9. アセット管理

### 9.1 画像フォーマット

- **形式**: PNG
- **配置**: `/public/assets/` ディレクトリ
- **用途**: スプライト、タイル、背景、UI 要素

### 9.2 フォント

- **形式**: TTF
- **フォント**: `Round9x13.ttf` - ピクセルフォント

---

## 10. 依存関係一覧

### 10.1 本番依存関係

```json
{
  "phaser": "^3.80.1",
  "next": "16.1.1",
  "react": "19.2.3",
  "react-dom": "19.2.3"
}
```

### 10.2 開発依存関係

```json
{
  "@biomejs/biome": "2.2.0",
  "@tailwindcss/postcss": "^4",
  "@types/node": "^20",
  "@types/react": "^19",
  "@types/react-dom": "^19",
  "tailwindcss": "^4",
  "typescript": "^5"
}
```

---

## 11. 技術選定理由

### 11.1 Phaser3

- **理由**: 2D ゲーム開発に特化した強力なゲームエンジン
- **利点**:
  - 豊富な API とドキュメント
  - 物理エンジンが内蔵
  - アニメーションシステムが充実
  - コミュニティが活発

### 11.2 Next.js 16

- **理由**: React ベースのモダンな Web アプリケーションフレームワーク
- **利点**:
  - サーバーサイドレンダリング対応
  - 高速な開発体験
  - 自動コード分割
  - ホットリロード対応

### 11.3 TypeScript

- **理由**: 型安全性による開発効率とバグ削減
- **利点**:
  - コンパイル時エラー検出
  - IDE の自動補完
  - リファクタリングの安全性

### 11.4 Tailwind CSS

- **理由**: 迅速な UI 開発と一貫性のあるデザイン
- **利点**:
  - ユーティリティファーストのアプローチ
  - カスタマイズ性
  - バンドルサイズの最適化

---

## 12. 参考資料

### 12.1 公式ドキュメント

- [Phaser3 公式ドキュメント](https://photonstorm.github.io/phaser3-docs/)
- [Phaser3 公式例](https://phaser.io/examples)
- [Next.js 公式ドキュメント](https://nextjs.org/docs)
- [React 公式ドキュメント](https://react.dev/)
- [TypeScript 公式ドキュメント](https://www.typescriptlang.org/docs/)

### 12.2 コミュニティリソース

- [Phaser3 コミュニティ](https://phaser.io/community)
- [Next.js コミュニティ](https://nextjs.org/community)

---

## 13. 変更履歴

| 日付       | バージョン | 変更内容 |
| ---------- | ---------- | -------- |
| 2026-01-16 | 1.0        | 初版作成 |

---

**最終更新日**: 2026 年 01 月 16 日
**作成者**: 開発チーム
**承認者**: fujioka8700
