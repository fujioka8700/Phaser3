# ゲーム要件定義書

## 1. プロジェクト概要

### 1.1 ゲームタイトル

星のカービィ風横スクロールアクションゲーム（仮称）

### 1.2 開発環境

- **フレームワーク**: Phaser3
- **プラットフォーム**: Next.js 16 (Web ブラウザ)
- **開発言語**: TypeScript

### 1.3 画面サイズ

- **ゲーム画面**: 375px × 333px
- **画面モード**: 横スクロール（左右にスクロール）
- **レンダリング**: ピクセルアート（`pixelArt: true`）

---

## 2. ゲームコンセプト

### 2.1 ゲームジャンル

ファミコン時代の星のカービィをイメージした横スクロールアクションゲーム

### 2.2 ゲームの特徴

- シンプルで直感的な操作
- 横スクロールによる探索要素
- 敵を倒す、コインを集める、ゴールを目指す
- ピクセルアートによるレトロなビジュアル

---

## 3. ゲームシステム

### 3.1 基本操作

#### 3.1.1 プレイヤー操作

- **左右移動**: 左右キー / バーチャルコントローラーの左右ボタン
- **ジャンプ**: 上キー / バーチャルコントローラーのジャンプボタン
- **特殊アクション**: （将来実装予定）

#### 3.1.2 バーチャルコントローラー

- 画面下半分に配置（実装は後期）
- 左ボタン、右ボタン、ジャンプボタン
- タッチ操作に対応

### 3.2 物理システム

- **物理エンジン**: Phaser Arcade Physics
- **重力**: Y 軸方向 600px/s²
- **衝突判定**: プレイヤーとプラットフォーム、敵、アイテム、障害物

### 3.3 カメラシステム

- **カメラ**: プレイヤーを追従
- **スクロール範囲**: ワールドサイズに応じて設定
- **オフセット**: プレイヤーが画面中央よりやや左側に配置

---

## 4. ゲームオブジェクト

### 4.1 プレイヤーキャラクター

#### 4.1.1 基本仕様

- **スプライト**: `/assets/Player.png`
- **フレームサイズ**: 48px × 48px
- **初期位置**: ステージ開始地点
- **アニメーション**:
  - **待機**: フレーム 0（静止）
  - **歩行**: フレーム 4-7（ループ）
  - **ジャンプ**: フレーム 12（静止）

#### 4.1.2 能力

- **移動速度**: 160px/s
- **ジャンプ力**: -350px/s（上方向）
- **ライフ**: 3（将来実装予定）
- **無敵時間**: 被ダメージ後 1 秒（将来実装予定）

### 4.2 敵キャラクター

#### 4.2.1 敵の種類

**鳥（Bird）**

- **スプライト**: `/assets/Bird_1.png`, `/assets/Bird_2.png`
- **行動パターン**: 左右往復移動、または一定範囲で飛行
- **ダメージ**: プレイヤーに接触でダメージ

**クモ（Spider）**

- **スプライト**: `/assets/Spider_1.png`, `/assets/Spider_2.png`
- **行動パターン**: プラットフォーム上を左右往復、端で反転
- **ダメージ**: プレイヤーに接触でダメージ

**魚（Fish）**

- **スプライト**: `/assets/Fish_1.png`, `/assets/Fish_2.png`
- **行動パターン**: 水中エリアで上下移動（将来実装予定）
- **ダメージ**: プレイヤーに接触でダメージ

#### 4.2.2 敵の共通仕様

- プレイヤーに接触するとダメージ
- 倒すとスコア加算（将来実装予定）
- プラットフォームの端で自動的に反転

### 4.3 プラットフォーム

#### 4.3.1 プラットフォームの種類

**基本プラットフォーム**

- **スプライト**: `/assets/Platform.png`
- **用途**: 基本的な足場

**レンガタイル**

- **スプライト**: `/assets/Brick_Tileset.png`
- **用途**: レンガの壁や床

**草タイル**

- **スプライト**: `/assets/Grass_Tileset.png`
- **用途**: 自然な地面

**石タイル**

- **スプライト**: `/assets/Stone_Tileset.png`
- **用途**: 石造りの構造物

**雲タイル**

- **スプライト**: `/assets/Cloud_Tileset.png`
- **用途**: 空のプラットフォーム

**葉タイル**

- **スプライト**: `/assets/Leaf_Tileset.png`
- **用途**: 森のエリア

**草と岩タイル**

- **スプライト**: `/assets/Grass_Rock_Tileset.png`
- **用途**: 自然な地形

#### 4.3.2 ワンウェイプラットフォーム

- **スプライト**: `/assets/Brick_Oneway.png`, `/assets/Grass_Oneway.png`, `/assets/Grass_Rock_Oneway.png`
- **仕様**: 下から上にのみ通過可能

### 4.4 障害物

#### 4.4.1 障害物の種類

**トゲ**

- **スプライト**: `/assets/Spike.png`, `/assets/Spike_Block.png`, `/assets/Spike_Platform.png`
- **効果**: 接触でダメージ

**炎**

- **スプライト**: `/assets/Flame_1.png`, `/assets/Flame_2.png`
- **効果**: 接触でダメージ、アニメーション表示

**丸ノコギリ**

- **スプライト**: `/assets/Circular_Saw.png`
- **効果**: 回転しながら移動、接触でダメージ

**斧の罠**

- **スプライト**: `/assets/Axe_Trap.png`
- **効果**: 振り子のように動く、接触でダメージ

**溶岩**

- **スプライト**: `/assets/Lava.png`
- **効果**: 落下で即死（将来実装予定）

### 4.5 アイテム

#### 4.5.1 コイン

- **スプライト**: `/assets/Coin.png`
- **効果**: 取得でスコア加算
- **アニメーション**: 回転アニメーション（将来実装予定）

#### 4.5.2 星（将来実装予定）

- **スプライト**: `/assets/Star_Green.png`, `/assets/Star_Red.png`, `/assets/Star_Yellow.png`
- **効果**: 特殊アイテム、パワーアップなど

### 4.6 ギミック

#### 4.6.1 バウンスパッド

- **スプライト**: `/assets/Bouncepad_Green.png`, `/assets/Bouncepad_Red.png`, `/assets/Bouncepad_Wood.png`
- **効果**: 踏むと高くジャンプできる

#### 4.6.2 はしご

- **スプライト**: `/assets/Ladder.png`
- **効果**: 上下移動が可能（将来実装予定）

#### 4.6.3 ロープ

- **スプライト**: `/assets/Rope.png`
- **効果**: ぶら下がって移動（将来実装予定）

#### 4.6.4 レール

- **スプライト**: `/assets/Rails.png`
- **効果**: レール上を移動（将来実装予定）

#### 4.6.5 橋

- **スプライト**: `/assets/Bridge.png`
- **効果**: 移動可能なプラットフォーム

#### 4.6.6 水

- **スプライト**: `/assets/Water.png`
- **効果**: 水中エリア（将来実装予定）

### 4.7 背景

#### 4.7.1 背景の種類

- **空**: `/assets/Sky_Background_0.png`, `/assets/Sky_Background_1.png`, `/assets/Sky_Background_2.png`
- **森**: `/assets/Forest_Background_0.png`
- **城**: `/assets/Castle_Background_0.png`
- **雲**: `/assets/Clouds.png`

#### 4.7.2 背景の仕様

- パララックススクロール効果（将来実装予定）
- 複数レイヤーで奥行きを表現

---

## 5. ゲームシーン

### 5.1 タイトルシーン（TitleScene）

- **背景色**: `#3c3e50`
- **要素**:
  - タイトルテキスト「ワンクリックゲーム」（将来変更予定）
  - 「クリックして開始」テキスト
  - クリックでメインシーンへ遷移

### 5.2 メインシーン（MainScene）

- **背景色**: `#2c3e50`
- **要素**:
  - ゲームのメインループ
  - プレイヤー、敵、プラットフォーム、アイテムなど
  - スコア表示（将来実装予定）
  - ライフ表示（将来実装予定）

### 5.3 開発シーン（DevScene）

- **用途**: 開発・デバッグ用
- **切り替え**: スペースキーで MainScene と切り替え
- **表示**: 「開発画面」テキスト

### 5.4 クリアシーン（ClearScene）

- **背景色**: `#27ae60`
- **要素**:
  - 「クリア！」メッセージ
  - 「クリックしてタイトルに戻る」テキスト
  - クリックでタイトルシーンへ遷移

### 5.5 ゲームオーバーシーン（将来実装予定）

- **背景色**: `#c0392b`
- **要素**:
  - 「ゲームオーバー」メッセージ
  - スコア表示
  - リトライ / タイトルに戻る選択

---

## 6. ゲームルール

### 6.1 勝利条件

- ステージのゴール地点に到達

### 6.2 敗北条件

- ライフが 0 になる（将来実装予定）
- 溶岩や深い穴に落下（将来実装予定）

### 6.3 スコアシステム（将来実装予定）

- コイン取得: +10 ポイント
- 敵撃破: +50 ポイント
- タイムボーナス: 残り時間に応じて

---

## 7. 技術仕様

### 7.1 Phaser 設定

```typescript
{
  type: Phaser.AUTO,
  width: 375,
  height: 333,
  scale: {
    mode: Phaser.Scale.FIT,
    autoCenter: Phaser.Scale.CENTER_BOTH,
  },
  physics: {
    default: 'arcade',
    arcade: {
      gravity: { x: 0, y: 600 },
      debug: isDebug, // 開発時のみ true
    },
  },
  pixelArt: true,
}
```

### 7.2 ワールドサイズ

- **幅**: 2400px 以上（ステージに応じて調整）
- **高さ**: 600px 以上（ステージに応じて調整）
- **境界**: プレイヤーはワールド境界で停止

### 7.3 パフォーマンス

- 60FPS を目標
- オブジェクトプーリングの活用（将来実装予定）
- 画面外のオブジェクトの非表示（将来実装予定）

---

## 8. 実装フェーズ

### フェーズ 1: 基本実装（現在）

- ✅ プレイヤーキャラクターの表示と移動
- ✅ 基本的なプラットフォーム
- ✅ ジャンプ機能
- ✅ バーチャルコントローラー（基本構造）
- ✅ シーン遷移（タイトル、メイン、クリア）

### フェーズ 2: ゲーム要素の追加

- [ ] 敵キャラクターの実装
- [ ] コイン収集システム
- [ ] スコア表示
- [ ] ゴール地点の実装
- [ ] 複数のプラットフォームタイプ

### フェーズ 3: 障害物とギミック

- [ ] トゲ、炎などの障害物
- [ ] バウンスパッド
- [ ] その他のギミック

### フェーズ 4: ステージデザイン

- [ ] 複数ステージの作成
- [ ] 背景の実装とパララックス効果
- [ ] ステージ選択画面

### フェーズ 5: ゲームシステムの完成

- [ ] ライフシステム
- [ ] ゲームオーバーシーン
- [ ] サウンドエフェクト
- [ ] BGM
- [ ] エフェクト（パーティクル）

### フェーズ 6: ポリッシュ

- [ ] アニメーションの改善
- [ ] UI/UX の改善
- [ ] バランス調整
- [ ] モバイル最適化

---

## 9. アセット一覧

### 9.1 キャラクター

- `Player.png` - プレイヤーキャラクター（48×48px/フレーム）

### 9.2 敵

- `Bird_1.png`, `Bird_2.png` - 鳥
- `Spider_1.png`, `Spider_2.png` - クモ
- `Fish_1.png`, `Fish_2.png` - 魚

### 9.3 プラットフォーム

- `Platform.png` - 基本プラットフォーム
- `Brick_Tileset.png` - レンガタイル
- `Grass_Tileset.png` - 草タイル
- `Stone_Tileset.png` - 石タイル
- `Cloud_Tileset.png` - 雲タイル
- `Leaf_Tileset.png` - 葉タイル
- `Grass_Rock_Tileset.png` - 草と岩タイル
- `Brick_Oneway.png` - レンガワンウェイ
- `Grass_Oneway.png` - 草ワンウェイ
- `Grass_Rock_Oneway.png` - 草と岩ワンウェイ

### 9.4 障害物

- `Spike.png`, `Spike_Block.png`, `Spike_Platform.png` - トゲ
- `Flame_1.png`, `Flame_2.png` - 炎
- `Circular_Saw.png` - 丸ノコギリ
- `Axe_Trap.png` - 斧の罠
- `Lava.png` - 溶岩

### 9.5 アイテム

- `Coin.png` - コイン
- `Star_Green.png`, `Star_Red.png`, `Star_Yellow.png` - 星

### 9.6 ギミック

- `Bouncepad_Green.png`, `Bouncepad_Red.png`, `Bouncepad_Wood.png` - バウンスパッド
- `Ladder.png` - はしご
- `Rope.png` - ロープ
- `Rails.png` - レール
- `Bridge.png` - 橋
- `Water.png` - 水

### 9.7 背景

- `Sky_Background_0.png`, `Sky_Background_1.png`, `Sky_Background_2.png` - 空
- `Forest_Background_0.png` - 森
- `Castle_Background_0.png` - 城
- `Clouds.png` - 雲

### 9.8 UI

- `Coins_Ui.png` - コイン UI
- `Stars_Ui.png` - 星 UI
- `Logo.png` - ロゴ

### 9.9 フォント

- `Round9x13.ttf` - ピクセルフォント

---

## 10. 今後の拡張案

### 10.1 ゲームプレイ

- パワーアップアイテム（星のカービィの能力吸収のようなシステム）
- ボス戦
- 隠しエリア
- コレクション要素

### 10.2 技術

- ステート管理の改善
- オブジェクトプーリング
- セーブ/ロード機能
- リプレイ機能

### 10.3 コンテンツ

- 複数ステージ
- 難易度選択
- 実績システム
- ランキング機能

---

## 11. 参考資料

### 11.1 参考ゲーム

- 星のカービィ（ファミコン版）
- スーパーマリオブラザーズ

### 11.2 技術ドキュメント

- [Phaser3 公式ドキュメント](https://photonstorm.github.io/phaser3-docs/)
- [Phaser3 公式例](https://phaser.io/examples)

---

## 12. 変更履歴

| 日付       | バージョン | 変更内容 |
| ---------- | ---------- | -------- |
| 2026-01-16 | 1.0        | 初版作成 |

---

**最終更新日**: 2026 年 01 月 16 日
**作成者**: 開発チーム
**承認者**: fujioka8700
